#-------------------------------- matutil.h ---------------------------------
# Contains utility routines for basic operations with vectors and matrices
#----------------------------------------------------------------------------
from math import *
#============================================================================
def MatPrint(a, n, m):
#----------------------------------------------------------------------------
# Prints the elements of matrix a[1:n][1:m] on the display
#----------------------------------------------------------------------------
	for i in range(1,n+1):
		for j in range (1,m+1): print('{0:11.2e}'.format(a[i][j]),end="")
		print()
#============================================================================
def MatTrans(a, n):
#----------------------------------------------------------------------------
# Replaces the square matrix a[1:n][1:n] by its transpose
#----------------------------------------------------------------------------
	for i in range(2,n+1):
		for j in range(1,i):
			t = a[i][j]; a[i][j] = a[j][i]; a[j][i] = t
#============================================================================
def MatDiff(a, b, c, n, m):
#----------------------------------------------------------------------------
# Returns the difference of matrices a and b in c[1:n][1:m]
#----------------------------------------------------------------------------
	for i in range(1,n+1):
		for j in range (1,m+1): c[i][j] = a[i][j] - b[i][j]
#============================================================================
def MatProd(a, b, c, n, l, m):
#----------------------------------------------------------------------------
# Returns the product of matrices a[1:n][1:l] and b[1:l][1:m] in c[1:n][1:m]
#----------------------------------------------------------------------------
	for i in range(1,n+1):
		for j in range (1,m+1):
			t = 0e0
			for k in range(1,l+1): t += a[i][k] * b[k][j]
			c[i][j] = t
#============================================================================
def MatNorm(a, n, m):
#----------------------------------------------------------------------------
# Returns the max norm of matrix a[1:n][1:m], i.e. max|a[i][j]|
#----------------------------------------------------------------------------
	norm = 0e0
	for i in range(1,n+1):
		for j in range(1,m+1):
			if (norm < fabs(a[i][j])): norm = fabs(a[i][j])
	return norm